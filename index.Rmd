---
title: "Exploratory Analysis"
output: html_document
---

## Project title

Give your project a concise, interesting title that summarizes the entirety of your project

### Authors

Names of your team members

### Date

Winter 2022

### Abstract

No more than three sentences that summarize your project. Focus on the very most important aspects. For example: (1) "Our main question is .... This question is important because .... To address the question, we will ...." (2) "We are concerned with ..., because .... To address this concern, we plan to ...." (3) "Consider that .... This is important because .... Accordingly, we plan to ...."

### Keywords

3-5 keywords that summarize your project.
(e.g., "Keywords: human physiology; bicycle exercise; Gen Z; times-series data")

### Introduction  

Briefly introduce your project.  Include 3-5 research questions. What motivates the questions? Why are they important? (at least 200 words)

### Related Work  

Describe your topic and related work in this space. You must include 3 citations to related work (URLs to similar work, high quality articles from the popular press, research papers, etc. ) Please use a standard citation style of your choice. (at least 200 words)

### The Dataset

Where did you find the data? Please include a link to the data source  
Who collected the data?  
How was the data collected or generated?  
Why was the data collected?  
How many observations (rows) are in your data?  
How many features (columns) are in the data?  
What, if any, ethical questions or questions of power do you need to consider when working with this data?  
What are possible limitations or problems with this data?   (at least 200 words)

### Implications

Assuming you answer your research questions, briefly describe the expected or possible implications for technologists, designers, and policymakers. (at least 150 words)

### Limitations & Challenges
What challenges or limitations might you need to address with your project idea more broadly? Briefly discuss. (at least 150 words)

### Summary Information

Write a summary paragraph of findings that includes the 5 values calculated from your summary information R script
```{r, warning=F, message=F}
# Packages
library(dplyr)
library(tidyr)
library(ggplot2)

# Read dataset
Dt <- read.csv('accident.csv')
head(Dt)

# Factor for categorical variables
## STATE
States <- read.csv('States.csv')
Dt <- left_join(Dt, States, by = 'STATE')
## WEATHER
Weather <- read.csv('weather.csv')
Dt <- left_join(Dt, Weather, by = 'WEATHER1')

# Extract columns
Variable <- c('States', "DAY", "MONTH", 'YEAR', 'DAY_WEEK','LATITUDE','LONGITUD','Weather','ARR_HOUR','ARR_MIN','DRUNK_DR')
Dt.Table <- Dt[, Variable]
head(Dt.Table)

## Number_of_Cases_Stratified_Weather
summary_info <- list()
summary_info$'Number_of_Cases_Stratified_Weather' <- Dt.Table %>% group_by(States) %>% select(States, Weather) %>% table()

## Rank_of_Cases
Rank_of_Cases <- Dt.Table %>% group_by(States) %>% select(States) %>% count()
Rank_of_Cases <- Rank_of_Cases[order(Rank_of_Cases$n, decreasing = T), ]
summary_info$'Rank_of_Cases' <- Rank_of_Cases

## Max cases of accidents
summary_info$'Number_of_Cases_in_Each_Week'<- Dt.Table %>% select(DAY_WEEK) %>% table()

## Case involved drunk driver
summary_info$'Case_involved_Drunk_Driver' <- Dt.Table %>% group_by(States) %>% filter(DRUNK_DR != 0) %>% select(States) %>% count()

## Average arrival time
Dt.Table$ARR_MIN <- ifelse(Dt.Table$ARR_MIN < 60, Dt.Table$ARR_MIN / 60 , NA)
Dt.Table$ARR_HOUR <- ifelse(Dt.Table$ARR_HOUR < 24, Dt.Table$ARR_HOUR, NA)
Dt.Table$'EMS_Arrival_Time' <- round(Dt.Table$ARR_HOUR + Dt.Table$ARR_MIN, 2)
summary_info$'Average_Arrival_Time_for_Each_State' <- Dt.Table %>% select(States, EMS_Arrival_Time) %>% group_by(States) %>% summarise(Mean = round(mean(EMS_Arrival_Time, na.rm = T), 2))

summary_info
```


### Table

Include a table of aggregate information

Describe why you included the table and what information it reveals
```{r, warning=F, message=F}
# count of cases
state_case <- table(Dt.Table$States, useNA = 'ifany')
State.Name <- names(state_case)
state_case <- matrix(state_case, ncol = 1, nrow = length(State.Name), dimnames = list(State.Name, 'Number_of_Cases'))
state_case <- data.frame('States' = rownames(state_case), state_case)

# case in Rain
Death_in_Rain <- Dt.Table %>% group_by(States) %>% filter(Weather == "Rain") %>% select(States) %>% count()
colnames(Death_in_Rain)[2] <- 'Number_of_Cases_in_Rainy_Day' 

Summary_Table <- left_join(state_case, Death_in_Rain, by = 'States')

# case in 2018
Case_in_2015 <- Dt.Table %>% group_by(States) %>% filter(YEAR == 2015) %>% select(States) %>% count()
colnames(Case_in_2015)[2] <- 'Number_of_Cases_in_2015' 

Summary_Table <- left_join(Summary_Table, Case_in_2015, by = 'States')

# case involved drunk driver
Case_involved_Drunk_Driver <- Dt.Table %>% group_by(States) %>% filter(DRUNK_DR != 0) %>% select(States) %>% count()
colnames(Case_involved_Drunk_Driver)[2] <- 'Number_of_Cases_involved_Drunk_Driver' 

Summary_Table <- left_join(Summary_Table, Case_involved_Drunk_Driver, by = 'States')

# Longest EMS arrival time
Longest_EMS_Arrival_Time <- Dt.Table %>% group_by(States) %>% summarise(EMS_Arrival_Time = max(EMS_Arrival_Time, na.rm = T))

Summary_Table <- left_join(Summary_Table, Longest_EMS_Arrival_Time, by = 'States')

Summary_Table

# write.csv(Dt.Table, 'Accident Dataset (Cleaned).csv')
```


### Chart 1

Include a chart

Describe why you chose this chart and what information it reveals

Here's an example of how to run an R script inside an RMarkdown file:

``````{r, echo = FALSE, code = readLines("chart1_example.R")}
```

### Chart 2

Include a chart

Describe why you chose this chart and what information it reveals

This is because weather conditions may have an impact on traffic accidents, which can lead to more injuries or fatalities. For example, adverse weather conditions may lead to slippery roads, poor visibility, and poor vehicle control, which may increase the risk of traffic accidents. Therefore, analyzing the link between the number of accident deaths and injuries and weather helps us to better understand the impact of weather conditions on traffic accidents and take appropriate measures to reduce the incidence of traffic accidents and decrease the number of casualties.
At the same time, through the table, we found that it is true that the weather such as cloudy and rainy weather will increase the number of deaths and injuries in accidents. However, most of the serious injuries are during clear weather, which proves that the main reason for the number of serious injuries is not the weather.


``````{r, echo = FALSE, code = readLines("chart2_QINGDENG.R")}
```


### Chart 3

Include a chart

Describe why you chose this chart and what information it reveals

I decided to choose this chart due to how I was curious to see the correlation between accidents and state. The chart revealed that the states with the highest amount of accidents were Virginia, Colorado and Hawaii while Georgia, Washington and Tennessee had the lowest amount of accidents. If I were to go a step further I would check the fatality rate based on state and see if I can draw a connection.